<!doctype html>
<!--
/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
* Copyright 2014 Adobe
* All Rights Reserved.
*
* NOTICE: Adobe permits you to use, modify, and distribute this file in
* accordance with the terms of the Adobe license agreement accompanying
* it. If you have received this file from a source other than Adobe,
* then your use, modification, or distribution of it requires the prior
* written permission of Adobe.
**************************************************************************/
-->
<html>

<head>
	<meta charset="utf-8">
	<script src="./ext.js"></script>
	<script src="./lib/CSInterface.js"></script>
	<script src="./lib/jquery-1.9.1.js"></script>
	<script src="./lib/Vulcan.js"></script>
	<link href="css/style.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">
		$(document).ready(function () {

			// For functions which require interaction at the JavaScript level, we provide these JQuery-based
			// handlers, instead of directly invoking ExtendScript .This givs the JavaScript layer a chance
			// to pass data into the ExtendScript layer, and process the results.

			$("#copypresets").on("click", function (e) {
				e.preventDefault();

				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				csInterface.evalScript('$._PPP_.getUserName()', myUserNameFunction);

				if (OSVersion) {

					// The path always comes back with '/' path separators. Windows needs '\\'.

					if (OSVersion.indexOf("Windows") >= 0) {
						var initPath = 'C:\\Users\\' + username.innerHTML;
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var initPath = '/Users/' + username.innerHTML;
						var sep = '/';
					}

					path = path + sep + 'payloads' + sep + 'Effect\ Presets\ and\ Custom\ Items.prfpset';

					var readResult = window.cep.fs.readFile(path);

					if (0 == readResult.err) {

						// We build a path to the preset, based on the OS user's name.

						var addOutPath = '/Documents/Adobe/Premiere\ Pro/13.0/Profile-' + username.innerHTML +
							'/Effect\ Presets\ and\ Custom\ Items.prfpset';
						var fullOutPath = initPath + addOutPath;
						var writeResult = window.cep.fs.writeFile(fullOutPath, readResult.data);
						var resultMsg = "";

						if (0 == writeResult.err) {
							resultMsg = "Successfully copied effect presets from panel to current user configuration.";
						} else {
							resultMsg = "Failed to copy effect presets.";
						}

						var postToEventPanel = '$._PPP_.updateEventPanel(\'';
						postToEventPanel += resultMsg;
						postToEventPanel += '\'';
						postToEventPanel += ')';

						csInterface.evalScript(postToEventPanel);
					}
				}
			});

			$("#toggleproxy").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.toggleProxyState()', mySetProxyFunction);
				csInterface.evalScript('$._PPP_.getProjectProxySetting()', myGetProxyFunction);
			});

			$("#checkforums").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.openURLInDefaultBrowser("https://forums.adobe.com/community/premiere/sdk");
			});

			$("#openfolder").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\';
						path = path.replace(/\//g, sep);
						window.cep.process.createProcess('C:\\Windows\\explorer.exe', path);
					} else {
						window.cep.process.createProcess('/usr/bin/open', path);
					}
				}
			});

			$("#readAPIdocs").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.openURLInDefaultBrowser("http://ppro.aenhancers.com");
			});

			$("#newseqfrompreset").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep + 'PProPanel.sqpreset';

					var pre = '$._PPP_.createSequenceFromPreset(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#mappen").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.mappen(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#importspots").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.importspots(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#renderprotools").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.renderprotools(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#renderprotoolsvideo").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.renderprotoolsvideo(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#r128mixdown").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.r128mixdown(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#testlijst").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.testlijst(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#checkreset").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.checkreset(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#checkself").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.checkself(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#checkclient").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.checkclient(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#renderpreview").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.renderpreview(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#renderonline").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.renderonline(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#rendermaster").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.rendermaster(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#rendermxf").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.rendermxf(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#onlinetvmix").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.onlinetvmix(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#rendercustom").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				var videoformat = document.getElementById("videoformat").value;
				var audiolevel = document.getElementById("audiolevel").value;

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.rendercustom(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + "\',\'" + videoformat + "\',\'" + audiolevel + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#todatum").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.todatum(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#towoensdag").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.towoensdag(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#todonderdag").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.todonderdag(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#tomorgen").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.tomorgen(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#tonu").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.tonu(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#tosquare").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.tosquare(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#tovertical").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.tovertical(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#to169").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep;

					var pre = '$._PPP_.to169(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#stitchusingdefaultpreset").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep + 'example.epr';

					var pre = '$._PPP_.stitch(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#transcodeexternal").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)
					path = path + sep + 'payloads' + sep + 'Bake preview 9-16 (vertical) 540x960.epr';

					var pre = '$._PPP_.transcodeExternal(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#ingest").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep + 'example.epr';

					var pre = '$._PPP_.ingestFiles(\'';
					var post = '\'';
					var postpost = ');';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#transcodeusingdefaultpreset").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				var OSVersion = csInterface.getOSInformation();
				var path = csInterface.getSystemPath(SystemPath.EXTENSION);

				if (OSVersion) {
					// The path always comes back with '/' path separators. Windows needs '\\'.
					if (OSVersion.indexOf("Windows") >= 0) {
						var sep = '\\\\';
						path = path.replace(/\//g, sep);
					} else {
						var sep = '/';
					}

					// Build a String to pass the path to the script.
					// (Sounds more complicated than it is.)

					path = path + sep + 'payloads' + sep + 'example.epr';

					var pre = '$._PPP_.transcode(\'';
					var post = '\'';
					var postpost = ')';

					var whole_megillah = pre + path + post + postpost;

					csInterface.evalScript(whole_megillah);
				}
			});

			$("#editlog").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.editlog()', function(result) {
					var OSVersion = csInterface.getOSInformation();
					var path = csInterface.getSystemPath(SystemPath.EXTENSION);
					if (OSVersion) {
						// The path always comes back with '/' path separators. Windows needs '\\'.
						if (OSVersion.indexOf("Windows") >= 0) {
							var sep = '\\';
							path = path.replace(/\//g, sep);
							window.cep.process.createProcess('C:\\Windows\\explorer.exe', "Volumes/Mediapool/_JSON/Render_Logs/" + result + "_Render_Log.txt");
						} else {
							window.cep.process.createProcess('/usr/bin/open', "Volumes/Mediapool/_JSON/Render_Logs/" + result + "_Render_Log.txt");
						}
					}
				});
			});

			$("#openprojectfolder").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.openprojectfolder()', function(result) {
					var OSVersion = csInterface.getOSInformation();
					var path = csInterface.getSystemPath(SystemPath.EXTENSION);
					if (OSVersion) {
						// The path always comes back with '/' path separators. Windows needs '\\'.
						if (OSVersion.indexOf("Windows") >= 0) {
							var sep = '\\';
							path = path.replace(/\//g, sep);
							window.cep.process.createProcess('C:\\Windows\\explorer.exe', result);
						} else {
							window.cep.process.createProcess('/usr/bin/open', result);
						}
					}
				});
			});

			$("#testfunction").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.testfunction()', function(result) {
				});
			});

			$("#updateklantlog").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.updateklantlog()', function(result) {
				});
			});

			$("#importvideo").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.importvideo()', function(result) {
				});
			});

			$("#importae").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.importae()', function(result) {
				});
			});

			$("#importaudio").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.importaudio()', function(result) {
				});
			});

			$("#importaudiomediapool").on("click", function (e) {
				e.preventDefault();
				var csInterface = new CSInterface();
				csInterface.evalScript('$._PPP_.importaudiomediapool()', function(result) {
				});
			});

		});
	</script>
</head>

<body onLoad="onLoaded()">
	<button style="width: 74px; margin: 0; color: #ccc; background-color: #333;" onClick="javascript:history.go(0)">↻ Refresh</button>
	<div style="float: right; font-family: arial; font-size: 10px; width: 30%; color: #fff">V20.01.17.1</div><br/>
	<!--<p id="username">[uninitialized]</p>
	<p id="version_string">[uninitialized]</p>
	<p id="active_seq">[uninitialized]</p>
	<p id="proxies_on">Proxies enabled for sequence: </p>-->

	<div>
		<!--<h2>New in 13.0!</h2>-->
	</div>
	<div id="section4" class="sectionID">
		<!--
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<button class="controlBg textStyle" id="btn_PPRO57" onClick="evalScript('$._PPP_.closeAllProjectsOtherThanActiveProject()')">Close all but active project</button>
		<button class="controlBg textStyle" id="btn_PPRO58" onClick="evalScript('$._PPP_.findAllAdjustmentLayersInProject()')">Find all adjustment layers</button>
		<button class="controlBg textStyle" id="btn_PPRO59" onClick="evalScript('$._PPP_.consolidateDuplicates()')">Consolidate duplicate footage</button>
		<button class="controlBg textStyle" id="btn_PPRO60" onClick="evalScript('$._PPP_.closeAllSequences()')">Close all sequences (in active project)</button>
		<button class="controlBg textStyle" id="btn_PPRO62" onClick="evalScript('$._PPP_.reportSequenceVRSettings()')">Report sequence VR settings</button>
		<button class="controlBg textStyle" id="btn_PPRO63" onClick="evalScript('$._PPP_.openProjectItemInSource()')">Open selected project items in Source monitor</button>
		<button class="controlBg textStyle" id="btn_PPRO64" onClick="evalScript('$._PPP_.reinterpretFootage()')">Re-interpret selected project items</button>
		<button class="controlBg textStyle" id="btn_PPRO66" onClick="evalScript('$._PPP_.createSubSequence()')">Create sub-sequence</button>
		<button class="controlBg textStyle" id="btn_PPRO67" onClick="evalScript('$._PPP_.selectAllRetimedClips()')">Select all re-timed clips</button>
		<button class="controlBg textStyle" id="btn_PPRO68" onClick="evalScript('$._PPP_.selectReversedClips()')">Select all reversed clips</button>
		<button class="controlBg textStyle" id="btn_PPRO69" onClick="evalScript('$._PPP_.logConsoleOutput()')">Write log file of console output</button>
		<button id="stitchusingdefaultpreset">Stitch selected files in AME</button>
		-->
	</div>
	<div>


	<div>
		<!--<h2>System</h2>-->
	</div>
	<div id="section1" class="sectionID">
		<!--
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<button class="controlBg textStyle" id="btn_PPRO33" onClick="evalScript('$._PPP_.closeFrontSourceClip()')">Close front-most Source monitor clip</button>
		<button class="controlBg textStyle" id="btn_PPRO35" onClick="evalScript('$._PPP_.closeAllClipsInSourceMonitor()')">Close all clips in Source monitor</button>
		<button id="openfolder">Open PProPanel folder</button>
		<button class="controlBg textStyle" id="btn_PPRO7" onClick="evalScript('$._PPP_.pokeAnywhere()')">Poke Anywhere</button>
		<button id="checkforums">Check SDK Forums</button>
		<button id="readAPIdocs">Read API documentation</button>
		<button id="copypresets">Copy Presets</button>
		<button class="controlBg textStyle" id="btn_PPRO18" onClick="evalScript('$._PPP_.getnumAEProjectItems()')">AE project item count</button>
		<button class="controlBg textStyle" id="btn_PPRO49" onClick="evalScript('$._PPP_.turnOffStartDialog()')">Turn off Start dialog</button>
		<button class="controlBg textStyle" id="btn_PPRO55" onClick="evalScript('$._PPP_.enableNewWorldScripting()')">toggle NewWorld scripting</button>


		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		-->
	</div>
	<div>
		<!--<h2>Import and Create</h2>-->
	</div>
	<div id="section2" class="sectionID">
		<!--
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<button id="ingest">Ingest files, create proxies</button>
		<button class="controlBg textStyle" id="btn_PPRO42" onClick="evalScript('$._PPP_.importMoGRT()')">Import MoGRT</button>
		<button class="controlBg textStyle" id="btn_PPRO2" onClick="evalScript('$._PPP_.createSequence()')">Create Sequence</button>
		<button class="controlBg textStyle" id="btn_PPRO37" onClick="evalScript('$._PPP_.importComps()')">Import Composition(s) from AE project</button>
		<button id="newseqfrompreset">Create Sequence From Preset</button>
		<button class="controlBg textStyle" id="btn_PPRO3" onClick="evalScript('$._PPP_.openProject()')">Open different project</button>
		<button class="controlBg textStyle" id="btn_PPRO5" onClick="evalScript('$._PPP_.importFiles()')">Import Files</button>
		<button class="controlBg textStyle" id="btn_PPRO8" onClick="evalScript('$._PPP_.openInSource()')">Open in Source Monitor...</button>
		<button class="controlBg textStyle" id="btn_PPRO23" onClick="evalScript('$._PPP_.setScratchDisk()')">Set scratch disk path</button>
		<button class="controlBg textStyle" id="btn_PPRO24" onClick="evalScript('$._PPP_.setProxiesON()')">Add proxy to first projItem</button>
		<button class="controlBg textStyle" id="btn_PPRO25" onClick="evalScript('$._PPP_.clearCache()')">Clear media cache</button>
		<p> </p>
		<p> </p>
		<div id="dragthing" draggable="true" ondragstart="dragHandler(event)">Drag and drop import</div>
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		-->
	</div>
	<div>
		<!--<h2>Metadata and Project manipulation</h2>-->
	</div>
	<div id="section3" class="sectionID">
		<!--
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<button id="toggleproxy">Toggle proxies in active project</button>
		<button class="controlBg textStyle" id="btn_PPRO9" onClick="evalScript('$._PPP_.replaceMedia()')">Replace media...</button>
		<button class="controlBg textStyle" id="btn_PPRO10" onClick="evalScript('$._PPP_.createSequenceMarkers()')">Add sequence markers</button>
		<button class="controlBg textStyle" id="btn_PPRO16" onClick="evalScript('$._PPP_.addClipMarkers()')">Add clip markers</button>
		<button class="controlBg textStyle" id="btn_PPRO17" onClick="evalScript('$._PPP_.updatePAR()')">Update PAR</button>
		<button class="controlBg textStyle" id="btn_PPRO11" onClick="evalScript('$._PPP_.mungeXMP()')">Manipulate XMP</button>
		<button class="controlBg textStyle" id="btn_PPRO14" onClick="evalScript('$._PPP_.updateGrowingFile()')">Update growing file</button>
		<button class="controlBg textStyle" id="btn_PPRO15" onClick="evalScript('$._PPP_.modifyProjectMetadata()')">Modify project metadata</button>
		<p> </p>
		<button class="controlBg textStyle" id="btn_PPRO27" onClick="evalScript('$._PPP_.randomizeSequenceSelection()')">Randomize sequence selection</button>
		<button class="controlBg textStyle" id="btn_PPRO28" onClick="evalScript('$._PPP_.muteFun()')">Mute fun!</button>
		<button class="controlBg textStyle" id="btn_PPRO29" onClick="evalScript('$._PPP_.onPlayWithKeyframes()')">Manipulate keyframes</button>
		<button class="controlBg textStyle" id="btn_PPRO30" onClick="evalScript('$._PPP_.insertOrAppend()')">insert or append to active sequence</button>
		<button class="controlBg textStyle" id="btn_PPRO56" onClick="evalScript('$._PPP_.insertOrAppendToTopTracks()')">insert or append, to top tracks</button>
		<button class="controlBg textStyle" id="btn_PPRO31" onClick="evalScript('$._PPP_.overWrite()')">overwrite at CTI</button>
		<button class="controlBg textStyle" id="btn_PPRO36" onClick="evalScript('$._PPP_.changeLabel()')">Label first projectItem</button>
		<button class="controlBg textStyle" id="btn_PPRO21" onClick="evalScript('$._PPP_.addSubClip()')">Create subclip</button>
		<button class="controlBg textStyle" id="btn_PPRO44" onClick="evalScript('$._PPP_.reportCurrentProjectSelection()')">Report selection to Events panel</button>
		<button class="controlBg textStyle" id="btn_PPRO43" onClick="evalScript('$._PPP_.randomizeProjectSelection()')">Randomize project selection</button>
		<button class="controlBg textStyle" id="btn_PPRO45" onClick="evalScript('$._PPP_.setOffline()')">Make selected items offline</button>
		<button class="controlBg textStyle" id="btn_PPRO47" onClick="evalScript('$._PPP_.setAllOnline()')">Online all offline</button>
		<button class="controlBg textStyle" id="btn_PPRO48" onClick="evalScript('$._PPP_.updateFrameRate()')">Update framerate</button>
		<button class="controlBg textStyle" id="btn_PPRO50" onClick="evalScript('$._PPP_.changeMarkerColors()')">Change marker colors</button>
		<button class="controlBg textStyle" id="btn_PPRO52" onClick="evalScript('$._PPP_.changeSeqTimeCodeDisplay()')">Change sequence timecode display</button>
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<h2>Export</h2>
		-->
	</div>
	<div id="section4" class="sectionID">
		<!--
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		<button id="transcodeusingdefaultpreset">Transcode first project item</button>
		<button id="transcodeexternal">Transcode external file</button>
		<button class="controlBg textStyle" id="btn_PPRO41" onClick="evalScript('$._PPP_.consolidateProject()')">Consolidate & Transfer project</button>
		<button class="controlBg textStyle" id="btn_PPRO20" onClick="evalScript('$._PPP_.dumpXMPFromAllProjectItems()')">Dump XMP from all items</button>
		<button class="controlBg textStyle" id="btn_PPRO34" onClick="evalScript('$._PPP_.saveProjectCopy()')">Save project copy...</button>
		<button class="controlBg textStyle" id="btn_PPRO4" onClick="evalScript('$._PPP_.saveProject()')">Save project</button>
		<button class="controlBg textStyle" id="btn_PPRO13" onClick="evalScript('$._PPP_.exportCurrentFrameAsPNG()')">Export sequence frame</button>
		<button class="controlBg textStyle" id="btn_PPRO26" onClick="evalScript('$._PPP_.exportFramesForMarkers()')">Export frames for markers</button>
		<button class="controlBg textStyle" id="btn_PPRO12" onClick="evalScript('$._PPP_.exportSequenceAsPrProj()')">New project from sequence</button>
		<button class="controlBg textStyle" id="btn_PPRO65" onClick="evalScript('$._PPP_.exportCurrentFrameAsPNG()')">Export sequence frame</button>
		<button class="controlBg textStyle" id="btn_PPRO6" onClick="evalScript('$._PPP_.exportFCPXML()')">Export FCP XML</button>
		<button class="controlBg textStyle" id="btn_PPRO20" onClick="evalScript('$._PPP_.dumpXMPFromAllProjectItems()')">Dump XMP from all items</button>
		<button class="controlBg textStyle" id="btn_PPRO22" onClick="evalScript('$._PPP_.exportAAF()')">Export sequence to AAF</button>
		-->
		<button type="button" class="collapsible"><h2 class="decorated"><span>Project</span></h2></button>
		<div class="content">
			<button style="width: 98px; color: #ccc; background-color: #333" id="mappen">Maak Mappen</button>
			<button style="width: 98px; color: #ccc; background-color: #333" id="openprojectfolder">Projectmap</button><br/>
			<!--<button style="width: 200px; color: #ccc; background-color: #333" id="importspots">Importeer Spots</button><br/>-->
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Import</span></h2></button>
		<div class="content">
			<button style="width: 64px; color: #ccc; background-color: #333; border: 1px solid #4b5f80" id="importvideo">Video</button>
			<button style="width: 64px; color: #ccc; background-color: #333; border: 1px solid #5f4f80" id="importae">AE</button>
			<button style="width: 64px; color: #ccc; background-color: #333; border: 1px solid #288059" id="importaudio">Audio</button><br/>
			<button style="width: 200px; color: #ccc; background-color: #333; border: 1px solid #808020" id="importaudiomediapool">Audio van Mediapool</button><br/>
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Protools</span></h2></button>
		<div class="content">
			<button style="width: 200px; color: #ccc; background-color: #333" id="renderprotools">Render Play-out + OMF</button><br/>
			<button style="width: 200px; color: #ccc; background-color: #333" id="renderprotoolsvideo">Render Play-out</button><br/>
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Status</span></h2></button>
		<div class="content">
			<button style="width: 47px; color: #ccc; background-color: #333; border: 1px solid #803758" id="checkreset">WIP</button>
			<button style="width: 47px; color: #ccc; background-color: #333; border: 1px solid #7c8039" id="checkself">Klaar</button>
			<button style="width: 98px; color: #ccc; background-color: #333; border: 1px solid #3c803c" id="checkclient">Goedgekeurd</button><br/>
			<!--<button style="width: 98px; color: #ccc; background-color: #333; border: 1px solid #4bbfdd" id="checkgraphics">Geen graphics</button>
			<button style="width: 98px; color: #ccc; background-color: #333; border: 1px solid #4d18fd" id="checksubs">Geen subs</button><br/>
			<button style="width: 98px; color: #ccc; background-color: #333; border: 1px solid #e8a742" id="checkaudio">Geen audio</button>
			<button style="width: 98px; color: #ccc; background-color: #333; border: 1px solid #874418" id="checknewaudio">Vervang audio</button><br/>-->
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Export</span></h2></button>
		<div class="content">
			<button style="width: 64px; color: #ccc; background-color: #333" id="renderpreview">Preview</button>
			<button style="width: 64px; color: #ccc; background-color: #333" id="renderonline">Online</button>
			<!--<button style="width: 200px; color: #ccc; background-color: #333" id="rendermaster">Render Master Prores 4444</button><br/>-->
			<button style="width: 64px; color: #ccc; background-color: #333" id="rendermxf">MXF</button><br/>
			<select name="videoformat" id="videoformat" style="width: 80px; color: #ccc; background-color: #333; color: #fff; font-size: 10px;">
				<option value="h264">H.264</option>
				<option value="h2642">H.264 (2,5mb)</option>
				<option value="h2644">H.264 (4mb)</option>
				<option value="h2645">H.264 (5mb)</option>
				<option value="h26410">H.264 (10mb)</option>
				<option value="h26425">H.264 (25mb)</option>
				<option value="h264100">H.264 (100mb)</option>
				<option value="prores4444">Prores 4444</option>
				<option value="prores422">Prores 422</option>
				<option value="png">PNG</option>
				<option value="tiff">TIFF</option>
			</select>
			<select name="audiolevel" id="audiolevel" style="width: 56px; color: #ccc; background-color: #333; color: #fff; font-size: 10px;">
				<option value="r128">R128</option>
				<option value="online">Online</option>
			</select>
			<button style="width: 56px; color: #ccc; background-color: #333; font-size: 11px;" id="rendercustom">Render</button><br/>
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Releasedatum</span></h2></button>
		<div class="content">
			<button style="width: 98px; color: #ccc; background-color: #333" id="todatum">DATUM</button>
			<button style="width: 98px; color: #ccc; background-color: #333" id="tonu">NU</button><br/>
			<button style="width: 64px; color: #ccc; background-color: #333" id="towoensdag">WOE</button>
			<button style="width: 64px; color: #ccc; background-color: #333" id="todonderdag">DON</button>
			<button style="width: 64px; color: #ccc; background-color: #333" id="tomorgen">MORGEN</button>
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Aspectratio</span></h2></button>
		<div class="content">
			<button style="width: 64px; color: #ccc; background-color: #333" id="tosquare">1x1</button>
			<button style="width: 64px; color: #ccc; background-color: #333" id="tovertical">9x16</button>
			<button style="width: 64px; color: #ccc; background-color: #333" id="to169">16x9</button><br/>
		</div>
		<button type="button" class="collapsible"><h2 class="decorated"><span>Audio</span></h2></button>
		<div class="content">
			<button style="width: 200px; color: #ccc; background-color: #333" id="r128mixdown">R128 Mixdown</button><br/>
			<button style="width: 200px; color: #ccc; background-color: #333" id="onlinetvmix">Export Online + TV mix</button><br/>
		</div>
		<button type="button" class="collapsible" data-toggle="collapse" data-target="#panel1" ><h2 class="decorated"><span>Administratie</span></h2></button>
		<div id="panel1" class="content">
			<button style="width: 98px; color: #ccc; background-color: #333" id="editlog">Edit Log</button>
			<button style="width: 98px; color: #ccc; background-color: #333" id="updateklantlog">Update Logs</button><br/>
			<button style="width: 200px; color: #ccc; background-color: #333" id="testfunction">Test Knop</button><br/>
		</div>


		<!--
		<button class="controlBg textStyle" id="btn_PPRO32" onClick="evalScript('$._PPP_.saveCurrentProjectLayout()')">Save Project layout</button>
		<button class="controlBg textStyle" id="btn_PPRO51" onClick="evalScript('$._PPP_.setProjectPanelMeta()')">Load Project layout</button>
		<button class="controlBg textStyle" id="btn_PPRO61" onClick="evalScript('$._PPP_.dumpAllPresets()')">List available export presets</button>
		<p> </p>
		<p> </p>
		<p> </p>
		<p> </p>
		-->
	</div>
</body>

<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    }
  });
}
</script>
<script>
	document.body.onbeforeunload = function () {
		var csInterface = new CSInterface();
		var OSVersion = csInterface.getOSInformation();
		var appVersion = csInterface.hostEnvironment.appVersion;
		var versionAsFloat = parseFloat(appVersion);

		csInterface.evalScript('$._PPP_.closeLog()');

		if (versionAsFloat < 10.3) {
			var path = "file:///Library/Application Support/Adobe/CEP/extensions/PProPanel/payloads/onbeforeunload.html";

			if (OSVersion.indexOf("Windows") >= 0) {
				path =
					"file:///C:/Program%20Files%20(x86)/Common%20Files/Adobe/CEP/extensions/PProPanel/payloads/onbeforeunload.html"
			}
			csInterface.openURLInDefaultBrowser(path);
		}
	};

	var createFolders = function () {
		var csInterface = new CSInterface();
		csInterface.callScript(
			'_PPP_',
			'createDeepFolderStructure',
			function (res) {
				console.log('Successfully created folders!');
			},
			function (err) {
				console.error(err);
				alert(err.message);
			}, ['This', 'is', 'a', 'very', 'deep', 'folder', 'structure'], // 1st argument
			6 // 2nd argument
		);
	};
</script>
</script>

</html>
